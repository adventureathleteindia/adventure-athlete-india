<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experience Preview | Adventure Athlete India</title>
    <!-- Brand Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600&family=Source+Sans+3:wght@300;400;500;600&display=swap" rel="stylesheet">
    <!-- Chart.js for elevation profile -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --forest: #2D5A3D;
            --forest-dark: #1E3D2A;
            --amber: #D97706;
            --amber-light: #F59E0B;
            --dark: #1A202C;
            --slate: #64748b;
            --slate-dark: #475569;
            --white: #FFFFFF;
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --font-heading: 'Oswald', sans-serif;
            --font-body: 'Source Sans 3', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-body);
            font-size: 16px;
            line-height: 1.7;
            color: var(--dark);
            background: var(--gray-50);
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 24px;
        }

        header {
            background: var(--forest);
            color: var(--white);
            padding: 40px 24px;
            margin-bottom: 24px;
            text-align: center;
        }

        header h1 {
            font-family: var(--font-heading);
            font-size: 2rem;
            font-weight: 500;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        header .experience-meta {
            font-size: 14px;
            opacity: 0.85;
            letter-spacing: 0.5px;
        }

        .status-bar {
            background: var(--white);
            padding: 16px 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .status-badge {
            padding: 6px 14px;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .status-draft { background: #FEF3C7; color: #92400E; }
        .status-review { background: #DBEAFE; color: #1E40AF; }
        .status-final { background: #D1FAE5; color: #065F46; }

        .content-section {
            background: var(--white);
            margin-bottom: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .section-header {
            background: var(--gray-100);
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--gray-200);
        }

        .section-header h2 {
            font-family: var(--font-heading);
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--dark);
        }

        .section-actions { display: flex; gap: 8px; }

        .btn {
            padding: 10px 18px;
            font-family: var(--font-body);
            font-size: 14px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn:hover { transform: translateY(-1px); }
        .btn-copy { background: var(--forest); color: var(--white); }
        .btn-copy:hover { background: var(--forest-dark); }
        .btn-copy.copied { background: var(--amber); }
        .btn-edit { background: var(--slate); color: var(--white); }
        .btn-edit:hover { background: var(--slate-dark); }
        .btn-primary {
            background: var(--amber);
            color: var(--white);
            padding: 14px 28px;
            font-size: 15px;
        }
        .btn-primary:hover {
            background: var(--amber-light);
            box-shadow: 0 4px 15px rgba(217, 119, 6, 0.3);
        }
        .btn-download {
            background: var(--forest);
            color: var(--white);
        }
        .btn-download:hover {
            background: var(--forest-dark);
        }

        .section-content { padding: 20px; }

        .content-display {
            white-space: pre-wrap;
            font-size: 15px;
            line-height: 1.8;
            color: var(--slate-dark);
        }

        .content-edit {
            display: none;
            width: 100%;
            min-height: 200px;
            padding: 16px;
            font-family: var(--font-body);
            font-size: 15px;
            line-height: 1.8;
            border: 2px solid var(--forest);
            resize: vertical;
        }

        .content-edit:focus { outline: none; border-color: var(--amber); }
        .editing .content-display { display: none; }
        .editing .content-edit { display: block; }
        .editing .btn-edit { background: var(--amber); }

        .quick-facts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 16px;
            padding: 24px;
            background: var(--gray-50);
        }

        .fact-item { text-align: center; padding: 12px; }
        .fact-value {
            font-family: var(--font-heading);
            font-size: 1.5rem;
            font-weight: 500;
            color: var(--forest);
            margin-bottom: 4px;
        }
        .fact-label {
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: var(--slate);
        }

        .instagram-preview {
            background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
            padding: 3px;
        }
        .instagram-preview-inner { background: var(--white); padding: 20px; }
        .youtube-preview { background: #FF0000; padding: 3px; }
        .youtube-preview-inner { background: var(--white); padding: 20px; }

        .source-info {
            background: var(--white);
            border-left: 4px solid var(--amber);
            padding: 16px 20px;
            margin-bottom: 20px;
            font-size: 14px;
        }
        .source-info h4 {
            font-family: var(--font-heading);
            font-size: 13px;
            font-weight: 500;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: var(--amber);
            margin-bottom: 8px;
        }

        .checklist-section {
            background: var(--white);
            border-left: 4px solid var(--forest);
            padding: 20px;
            margin-bottom: 20px;
        }
        .checklist-section h3 {
            font-family: var(--font-heading);
            font-size: 16px;
            font-weight: 500;
            color: var(--forest);
            margin-bottom: 16px;
        }
        .checklist-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 0;
            border-bottom: 1px solid var(--gray-100);
            font-size: 14px;
        }
        .checklist-item:last-child { border-bottom: none; }
        .checklist-status {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            flex-shrink: 0;
        }
        .checklist-status.done { background: var(--forest); color: var(--white); }
        .checklist-status.missing { background: #EF4444; color: var(--white); }
        .checklist-status.warning { background: var(--amber); color: var(--white); }

        .finalize-section {
            background: var(--white);
            padding: 40px;
            text-align: center;
            margin-top: 32px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .finalize-section h3 {
            font-family: var(--font-heading);
            font-size: 1.3rem;
            font-weight: 500;
            margin-bottom: 12px;
            color: var(--dark);
        }
        .finalize-section p { color: var(--slate); margin-bottom: 24px; font-size: 15px; }

        .author-box { text-align: center; padding: 28px; }
        .author-name { font-family: var(--font-heading); font-size: 1.1rem; font-weight: 500; margin-bottom: 4px; }
        .author-brand { color: var(--slate); font-weight: 400; }
        .author-credentials { color: var(--slate); font-size: 14px; margin-bottom: 16px; }
        .author-links { display: flex; justify-content: center; gap: 24px; flex-wrap: wrap; }
        .author-links a { color: var(--forest); font-size: 14px; font-weight: 500; text-decoration: none; transition: color 0.2s; }
        .author-links a:hover { color: var(--amber); }

        .char-count { font-size: 12px; color: var(--slate); text-align: right; margin-top: 8px; }
        .char-count.warning { color: #EF4444; }

        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--dark);
            color: var(--white);
            padding: 14px 24px;
            font-size: 14px;
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        .toast.show { display: block; }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .elevation-section { background: var(--white); margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }

        .elevation-chart-container {
            padding: 20px;
            position: relative;
        }

        .elevation-chart-wrapper {
            position: relative;
            height: 250px;
            margin-bottom: 16px;
        }

        .elevation-stats {
            display: flex;
            justify-content: space-around;
            padding: 16px;
            background: var(--gray-50);
            border-top: 1px solid var(--gray-200);
        }

        .elevation-stat {
            text-align: center;
        }

        .elevation-stat-value {
            font-family: var(--font-heading);
            font-size: 1.2rem;
            font-weight: 500;
            color: var(--forest);
        }

        .elevation-stat-label {
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: var(--slate);
        }

        .no-elevation-data { padding: 40px; text-align: center; color: var(--slate); }
        .no-elevation-data p { margin-bottom: 8px; }

        .gpx-tabs {
            display: flex;
            gap: 8px;
            padding: 12px 20px;
            background: var(--gray-50);
            border-bottom: 1px solid var(--gray-200);
        }

        .gpx-tab {
            padding: 8px 16px;
            font-size: 13px;
            font-weight: 500;
            background: var(--white);
            border: 1px solid var(--gray-200);
            cursor: pointer;
            transition: all 0.2s;
        }

        .gpx-tab:hover {
            border-color: var(--forest);
        }

        .gpx-tab.active {
            background: var(--forest);
            color: var(--white);
            border-color: var(--forest);
        }

        .gpx-chart-panel {
            display: none;
        }

        .gpx-chart-panel.active {
            display: block;
        }

        @media (max-width: 600px) {
            .section-header { flex-direction: column; gap: 12px; }
            .quick-facts { grid-template-columns: repeat(2, 1fr); }
            header h1 { font-size: 1.6rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 id="experienceTitle">Ghepan Lake - Hike</h1>
            <div class="experience-meta" id="experienceMeta">Hiking | Hard | 2024-10-13</div>
        </header>

        <div class="status-bar">
            <div>
                <span class="status-badge status-review" id="statusBadge">Ready for Review</span>
            </div>
            <div style="font-size: 13px; color: #64748b;">
                <span id="lastUpdated">Generated just now</span>
            </div>
        </div>

        <!-- Source Info -->
        <div class="source-info">
            <h4>Content Generated From</h4>
            <div id="sourceInfo">
                <strong>Route:</strong> Labrang village (Near Sissu) to Ghepan Lake and back<br>
                <strong>Your notes:</strong> It was a first hike for me like I did not do multiple days track. I went early morning and came back in the evening. It was around 8 to 10 hours of hike for me. I took some food items like boiled potatoes, eggs, chocolate...
            </div>
        </div>

        <!-- Website Migration Checklist -->
        <div class="checklist-section">
            <h3>Website Migration Checklist</h3>
            <div class="checklist-item">
                <div class="checklist-status done">&#10003;</div>
                <span>Basic info complete (title, category, difficulty)</span>
            </div>
            <div class="checklist-item">
                <div class="checklist-status done">&#10003;</div>
                <span>Location complete (start/end, district, how to reach)</span>
            </div>
            <div class="checklist-item">
                <div class="checklist-status done">&#10003;</div>
                <span>Metrics available (distance, elevation, duration)</span>
            </div>
            <div class="checklist-item">
                <div class="checklist-status done">&#10003;</div>
                <span>Raw notes captured</span>
            </div>
            <div class="checklist-item">
                <div class="checklist-status done">&#10003;</div>
                <span>YouTube video linked (ySrJ9w9r8uQ)</span>
            </div>
            <div class="checklist-item">
                <div class="checklist-status done">&#10003;</div>
                <span>GPX file available (Ghepan_lake_fast_hike.gpx)</span>
            </div>
            <div class="checklist-item">
                <div class="checklist-status warning">!</div>
                <span>Photos added (7 photos in folder, but no hero image selected)</span>
            </div>
            <div class="checklist-item">
                <div class="checklist-status warning">!</div>
                <span>Strava activity link missing (not linked)</span>
            </div>
        </div>

        <!-- Quick Facts -->
        <div class="content-section">
            <div class="section-header">
                <h2>Quick Facts</h2>
            </div>
            <div class="quick-facts" id="quickFacts">
                <div class="fact-item">
                    <div class="fact-value" id="factDistance">23.3 km</div>
                    <div class="fact-label">Distance</div>
                </div>
                <div class="fact-item">
                    <div class="fact-value" id="factElevation">1609m</div>
                    <div class="fact-label">Elevation</div>
                </div>
                <div class="fact-item">
                    <div class="fact-value" id="factDuration">~10 hrs</div>
                    <div class="fact-label">Duration</div>
                </div>
                <div class="fact-item">
                    <div class="fact-value" id="factDifficulty">Hard</div>
                    <div class="fact-label">Difficulty</div>
                </div>
                <div class="fact-item">
                    <div class="fact-value" id="factAltitude">4076m</div>
                    <div class="fact-label">Max Altitude</div>
                </div>
                <div class="fact-item">
                    <div class="fact-value" id="factSeason">Autumn</div>
                    <div class="fact-label">Best Season</div>
                </div>
            </div>
        </div>

        <!-- Elevation Profile -->
        <div class="content-section elevation-section" id="elevationSection">
            <div class="section-header">
                <h2>Elevation Profile</h2>
                <div class="section-actions">
                    <button class="btn btn-download" onclick="downloadElevationPNG()" id="downloadElevationBtn">
                        Download PNG
                    </button>
                </div>
            </div>
            <!-- GPX Tabs (only shown if multiple GPX files) -->
            <div class="gpx-tabs" id="gpxTabs" style="display: none;">
                <!-- Tabs populated by JavaScript -->
            </div>
            <div id="elevationContent">
                <!-- Content populated by JavaScript based on elevation data -->
            </div>
        </div>

        <!-- Website Description -->
        <div class="content-section" id="websiteSection">
            <div class="section-header">
                <h2>Website Description</h2>
                <div class="section-actions">
                    <button class="btn btn-edit" onclick="toggleEdit('website')">Edit</button>
                    <button class="btn btn-copy" onclick="copyContent('website')">Copy</button>
                </div>
            </div>
            <div class="section-content">
                <div class="content-display" id="websiteDisplay">The kind of lake you think only exists in wallpapers - until you're standing next to it.

Ghepan Lake sits at 4076m in the Lahaul Valley, near Sissu. To get there you cross the Atal Tunnel from Manali, enter Lahaul, and start the hike about 1 km above Labrang village, roughly 3 km from Sissu. This was my first proper big hike. Not a multi-day trek, just a single-day out-and-back. Left early morning, came back by evening. Took about 10 hours total.

We were three people. Packed boiled potatoes, eggs, chocolate, and peanut butter bread for lunch. For gear I had trail running shoes, a jacket, cap, sunglasses, and a water pack, though honestly there's plenty of water on the trail so you don't need to carry much.

The route has four stream crossings. Three are manageable. One is genuinely difficult. Even in autumn when the water was lower, that one crossing made us work for it. My advice: start early. The glacier melts slower in the morning, so the water levels are lower and crossings get easier. By afternoon the meltwater picks up and it gets harder.

Autumn is the better season for this hike. Less water in the streams, clearer skies, and the valley looks incredible. If you go during peak summer, expect higher water and tougher crossings.

The altitude hits you. At 4076m, you feel it. Don't rush, take your time on the way up, and don't underestimate the mountain. This is not a casual walk. The elevation gain is over 1600m round trip, and by the time you're heading back you'll feel it in your legs and your lungs.

Getting There:
First reach Manali. From Manali, take a bus (about 2 hours) or a taxi through the Atal Tunnel into Lahaul Valley. Get to Sissu, then head to Labrang village. The hike starts about 1 km above the village.

What to Bring:
- Trail running or hiking shoes (good grip for stream crossings)
- Warm jacket (it gets cold at altitude)
- Cap and sunglasses
- Water pack (but trail has water)
- Food for the day (no shops on the trail)
- Hiking pole
- Mini oxygen cylinder (optional, but smart at this altitude)

Notes:
- Start early. Morning glacier melt is slower, stream crossings are easier.
- Don't underestimate the altitude. 4076m hits different if you're not acclimatized.
- 4 stream crossings. One is very difficult even in autumn.
- Autumn is best season. Less water, better conditions.</div>
                <textarea class="content-edit" id="websiteEdit"></textarea>
                <div class="char-count" id="websiteCount"></div>
            </div>
        </div>

        <!-- Instagram Caption -->
        <div class="content-section" id="instagramSection">
            <div class="section-header">
                <h2>Instagram Caption</h2>
                <div class="section-actions">
                    <button class="btn btn-edit" onclick="toggleEdit('instagram')">Edit</button>
                    <button class="btn btn-copy" onclick="copyContent('instagram')">Copy</button>
                </div>
            </div>
            <div class="section-content">
                <div class="instagram-preview">
                    <div class="instagram-preview-inner">
                        <div class="content-display" id="instagramDisplay">Ghepan Lake, 4076m. The kind of lake you think only exists in wallpapers.

My first big single-day hike. Left early morning from Labrang village near Sissu, reached the lake, and came back by evening. 23 km, 1600m of climbing, and four stream crossings where one nearly stopped us.

Start early. The glacier melts slower in the morning so the crossings are easier. By afternoon, good luck.

Don't underestimate this one.

üìç Lahaul Valley, Himachal Pradesh
üèî 23.3 km | ‚¨Ü 1609m | 4076m max
‚è± ~10 hrs

#ghepanlake #lahaulvalley #himachalpradesh #himalayanhiking #adventureathleindia</div>
                        <textarea class="content-edit" id="instagramEdit"></textarea>
                        <div class="char-count" id="instagramCount">0 / 2200 characters</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- YouTube Description -->
        <div class="content-section" id="youtubeSection">
            <div class="section-header">
                <h2>YouTube Description</h2>
                <div class="section-actions">
                    <button class="btn btn-edit" onclick="toggleEdit('youtube')">Edit</button>
                    <button class="btn btn-copy" onclick="copyContent('youtube')">Copy</button>
                </div>
            </div>
            <div class="section-content">
                <div class="youtube-preview">
                    <div class="youtube-preview-inner">
                        <div class="content-display" id="youtubeDisplay">Ghepan Lake Hike (4076m) - Lahaul Valley, Himachal Pradesh

A single-day out-and-back hike to one of the most stunning glacier lakes in Lahaul Valley. Starting from Labrang village near Sissu, this 23 km route climbs over 1600m through stream crossings and high-altitude terrain to reach Ghepan Lake at 4076m.

üìç Route: Labrang Village (near Sissu) - Ghepan Lake - Labrang Village
üìè Distance: 23.3 km
‚¨Ü Elevation: 1609m gain
‚è± Duration: ~10 hours
üéØ Difficulty: Hard
üèî Max Altitude: 4076m

---

ABOUT THIS HIKE:
Ghepan Lake sits deep in the Lahaul Valley, accessed through the Atal Tunnel from Manali. The trail has 4 stream crossings, one of which is very difficult even in autumn. Start early - glacier melt is slower in the morning, making crossings easier. The altitude hits hard at 4076m. Don't underestimate this mountain.

WARNING: Start early for easier stream crossings. Altitude sickness is real at 4076m. Don't go unprepared. Carry food for the full day.

---

WATCH THE FULL HIKE:
https://www.youtube.com/watch?v=ySrJ9w9r8uQ

---

FOLLOW MY ADVENTURES:
‚Üí Instagram: @adventureathlete.in
‚Üí YouTube: youtube.com/@adventureathleindia
‚Üí Strava: strava.com/athletes/atulchauhan

---

#ghepanlake #lahaulvalley #himachalpradesh #himalayanhiking #adventureathleindia</div>
                        <textarea class="content-edit" id="youtubeEdit"></textarea>
                        <div class="char-count" id="youtubeCount"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Short Summary -->
        <div class="content-section" id="summarySection">
            <div class="section-header">
                <h2>Short Summary</h2>
                <div class="section-actions">
                    <button class="btn btn-edit" onclick="toggleEdit('summary')">Edit</button>
                    <button class="btn btn-copy" onclick="copyContent('summary')">Copy</button>
                </div>
            </div>
            <div class="section-content">
                <div class="content-display" id="summaryDisplay">A 23 km single-day hike to a glacier lake at 4076m in Lahaul Valley. Four stream crossings, 1600m of climbing, and the kind of views that make you forget the altitude headache.</div>
                <textarea class="content-edit" id="summaryEdit" rows="3"></textarea>
            </div>
        </div>

        <!-- Author Section -->
        <div class="content-section" id="authorSection">
            <div class="section-header">
                <h2>Author Section</h2>
                <div class="section-actions">
                    <button class="btn btn-copy" onclick="copyAuthor()">Copy</button>
                </div>
            </div>
            <div class="author-box">
                <div class="author-name">Atul Chauhan <span class="author-brand">| Adventure Athlete India</span></div>
                <div class="author-credentials">Engineer | Mountain Biker | Trail Runner | National Level Athlete</div>
                <div class="author-links">
                    <a href="https://instagram.com/adventureathlete.in" target="_blank">Instagram</a>
                    <a href="https://youtube.com/@adventureathleindia" target="_blank">YouTube</a>
                    <a href="https://strava.com/athletes/atulchauhan" target="_blank">Strava</a>
                </div>
            </div>
        </div>

        <!-- Finalize -->
        <div class="finalize-section">
            <h3>Ready to Finalize?</h3>
            <p>Review all content above. Edit if needed. Then click finalize to save.</p>
            <button class="btn btn-primary" onclick="finalizeContent()">
                Finalize & Save Content
            </button>
            <p style="margin-top: 16px; font-size: 13px; color: #64748b;">
                This will download all content files. Move them to the experience's <code>content/</code> folder.
            </p>
        </div>
    </div>

    <div class="toast" id="toast">Copied to clipboard!</div>

    <script>
        function syncContent(section) {
            const display = document.getElementById(section + 'Display');
            const edit = document.getElementById(section + 'Edit');
            if (display && edit) {
                edit.value = display.textContent;
            }
        }

        function toggleEdit(section) {
            const sectionEl = document.getElementById(section + 'Section');
            const display = document.getElementById(section + 'Display');
            const edit = document.getElementById(section + 'Edit');

            if (sectionEl.classList.contains('editing')) {
                display.textContent = edit.value;
                sectionEl.classList.remove('editing');
            } else {
                sectionEl.classList.add('editing');
                edit.focus();
            }

            if (section === 'instagram') {
                updateCharCount('instagram');
            }
        }

        function copyContent(section) {
            const content = document.getElementById(section + 'Display').textContent;
            navigator.clipboard.writeText(content).then(() => {
                showToast('Copied to clipboard!');
                const btn = event.target.closest('.btn-copy');
                btn.classList.add('copied');
                btn.innerHTML = 'Copied!';
                setTimeout(() => {
                    btn.classList.remove('copied');
                    btn.innerHTML = 'Copy';
                }, 2000);
            });
        }

        function updateCharCount(section) {
            const edit = document.getElementById(section + 'Edit');
            const count = document.getElementById(section + 'Count');
            if (edit && count) {
                const len = edit.value.length;
                const max = section === 'instagram' ? 2200 : 5000;
                count.textContent = `${len} / ${max} characters`;
                count.classList.toggle('warning', len > max);
            }
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        function finalizeContent() {
            const finalContent = {
                website: document.getElementById('websiteEdit').value || document.getElementById('websiteDisplay').textContent,
                instagram: document.getElementById('instagramEdit').value || document.getElementById('instagramDisplay').textContent,
                youtube: document.getElementById('youtubeEdit').value || document.getElementById('youtubeDisplay').textContent,
                summary: document.getElementById('summaryEdit').value || document.getElementById('summaryDisplay').textContent
            };

            downloadFile('website.md', finalContent.website);
            setTimeout(() => downloadFile('instagram.md', finalContent.instagram), 500);

            if (finalContent.youtube && !finalContent.youtube.includes('{{')) {
                setTimeout(() => downloadFile('youtube.md', finalContent.youtube), 1000);
            }

            showToast('Content files downloaded!');
            document.getElementById('statusBadge').textContent = 'Finalized';
            document.getElementById('statusBadge').className = 'status-badge status-final';
        }

        function downloadFile(filename, content) {
            const blob = new Blob([content], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        document.getElementById('instagramEdit').addEventListener('input', () => updateCharCount('instagram'));

        function copyAuthor() {
            const authorText = `---\n\n**Atul Chauhan** | Adventure Athlete India\nEngineer | Mountain Biker | Trail Runner | National Level Athlete\n\n[Instagram](https://instagram.com/adventureathlete.in) | [YouTube](https://youtube.com/@adventureathleindia) | [Strava](https://strava.com/athletes/atulchauhan)`;

            navigator.clipboard.writeText(authorText).then(() => {
                showToast('Author section copied!');
                const btn = event.target.closest('.btn-copy');
                btn.classList.add('copied');
                btn.innerHTML = 'Copied!';
                setTimeout(() => {
                    btn.classList.remove('copied');
                    btn.innerHTML = 'Copy';
                }, 2000);
            });
        }

        // ==========================================
        // Elevation Profile Chart
        // ==========================================

        // Elevation data - subsampled every 4th point (~100m intervals) from GPX parse
        const elevationDataSets = [
  {
    "name": "Ghepan lake fast hike",
    "data": [
      {"distance":0,"elevation":3510.4},
      {"distance":0.1,"elevation":3522.2},
      {"distance":0.2,"elevation":3524.8},
      {"distance":0.3,"elevation":3532.4},
      {"distance":0.4,"elevation":3538.8},
      {"distance":0.5,"elevation":3556.4},
      {"distance":0.6,"elevation":3582.0},
      {"distance":0.7,"elevation":3600.6},
      {"distance":0.8,"elevation":3613.6},
      {"distance":0.9,"elevation":3632.4},
      {"distance":1.0,"elevation":3631.6},
      {"distance":1.1,"elevation":3640.4},
      {"distance":1.2,"elevation":3665.0},
      {"distance":1.31,"elevation":3677.0},
      {"distance":1.4,"elevation":3688.4},
      {"distance":1.5,"elevation":3698.0},
      {"distance":1.61,"elevation":3702.6},
      {"distance":1.7,"elevation":3707.2},
      {"distance":1.81,"elevation":3712.8},
      {"distance":1.91,"elevation":3719.8},
      {"distance":2.01,"elevation":3731.0},
      {"distance":2.11,"elevation":3736.6},
      {"distance":2.2,"elevation":3746.4},
      {"distance":2.3,"elevation":3754.0},
      {"distance":2.4,"elevation":3763.4},
      {"distance":2.5,"elevation":3769.8},
      {"distance":2.6,"elevation":3773.6},
      {"distance":2.7,"elevation":3776.2},
      {"distance":2.8,"elevation":3779.4},
      {"distance":2.9,"elevation":3784.4},
      {"distance":3.0,"elevation":3790.2},
      {"distance":3.1,"elevation":3796.6},
      {"distance":3.2,"elevation":3800.2},
      {"distance":3.3,"elevation":3803.0},
      {"distance":3.41,"elevation":3809.0},
      {"distance":3.5,"elevation":3801.2},
      {"distance":3.61,"elevation":3812.8},
      {"distance":3.7,"elevation":3815.4},
      {"distance":3.8,"elevation":3807.4},
      {"distance":3.9,"elevation":3796.4},
      {"distance":4.0,"elevation":3789.6},
      {"distance":4.09,"elevation":3787.8},
      {"distance":4.18,"elevation":3784.8},
      {"distance":4.28,"elevation":3777.6},
      {"distance":4.38,"elevation":3764.8},
      {"distance":4.48,"elevation":3753.6},
      {"distance":4.58,"elevation":3746.0},
      {"distance":4.68,"elevation":3733.6},
      {"distance":4.78,"elevation":3747.2},
      {"distance":4.88,"elevation":3775.6},
      {"distance":4.98,"elevation":3791.6},
      {"distance":5.08,"elevation":3803.8},
      {"distance":5.18,"elevation":3804.4},
      {"distance":5.28,"elevation":3803.4},
      {"distance":5.38,"elevation":3813.8},
      {"distance":5.48,"elevation":3839.2},
      {"distance":5.58,"elevation":3861.8},
      {"distance":5.68,"elevation":3872.0},
      {"distance":5.78,"elevation":3879.4},
      {"distance":5.88,"elevation":3878.0},
      {"distance":5.98,"elevation":3872.2},
      {"distance":6.08,"elevation":3886.2},
      {"distance":6.18,"elevation":3896.4},
      {"distance":6.28,"elevation":3905.4},
      {"distance":6.38,"elevation":3914.0},
      {"distance":6.48,"elevation":3932.2},
      {"distance":6.58,"elevation":3942.4},
      {"distance":6.68,"elevation":3944.4},
      {"distance":6.78,"elevation":3936.8},
      {"distance":6.88,"elevation":3927.2},
      {"distance":6.98,"elevation":3920.4},
      {"distance":7.08,"elevation":3902.0},
      {"distance":7.18,"elevation":3900.8},
      {"distance":7.28,"elevation":3884.0},
      {"distance":7.38,"elevation":3872.2},
      {"distance":7.48,"elevation":3873.4},
      {"distance":7.58,"elevation":3866.8},
      {"distance":7.68,"elevation":3868.6},
      {"distance":7.78,"elevation":3865.0},
      {"distance":7.88,"elevation":3844.8},
      {"distance":7.98,"elevation":3822.0},
      {"distance":8.08,"elevation":3811.4},
      {"distance":8.18,"elevation":3815.2},
      {"distance":8.28,"elevation":3825.4},
      {"distance":8.38,"elevation":3847.2},
      {"distance":8.48,"elevation":3867.4},
      {"distance":8.58,"elevation":3882.2},
      {"distance":8.68,"elevation":3899.6},
      {"distance":8.78,"elevation":3920.0},
      {"distance":8.88,"elevation":3934.4},
      {"distance":8.98,"elevation":3925.2},
      {"distance":9.08,"elevation":3915.2},
      {"distance":9.18,"elevation":3915.4},
      {"distance":9.29,"elevation":3916.6},
      {"distance":9.38,"elevation":3919.2},
      {"distance":9.48,"elevation":3936.8},
      {"distance":9.58,"elevation":3940.6},
      {"distance":9.68,"elevation":3927.0},
      {"distance":9.78,"elevation":3922.8},
      {"distance":9.89,"elevation":3926.0},
      {"distance":9.98,"elevation":3930.2},
      {"distance":10.08,"elevation":3934.2},
      {"distance":10.18,"elevation":3942.2},
      {"distance":10.28,"elevation":3954.6},
      {"distance":10.38,"elevation":3978.2},
      {"distance":10.49,"elevation":3989.0},
      {"distance":10.58,"elevation":3995.8},
      {"distance":10.68,"elevation":4008.6},
      {"distance":10.78,"elevation":4018.2},
      {"distance":10.88,"elevation":4029.6},
      {"distance":10.98,"elevation":4043.0},
      {"distance":11.08,"elevation":4046.4},
      {"distance":11.18,"elevation":4048.6},
      {"distance":11.28,"elevation":4054.6},
      {"distance":11.38,"elevation":4066.6},
      {"distance":11.48,"elevation":4070.0},
      {"distance":11.55,"elevation":4075.6},
      {"distance":11.65,"elevation":4049.0},
      {"distance":11.75,"elevation":4045.2},
      {"distance":11.85,"elevation":4037.0},
      {"distance":11.95,"elevation":4028.6},
      {"distance":12.05,"elevation":4021.8},
      {"distance":12.15,"elevation":4020.2},
      {"distance":12.25,"elevation":4016.0},
      {"distance":12.35,"elevation":4020.4},
      {"distance":12.45,"elevation":4028.4},
      {"distance":12.55,"elevation":4002.6},
      {"distance":12.65,"elevation":3998.4},
      {"distance":12.75,"elevation":3987.6},
      {"distance":12.85,"elevation":3960.2},
      {"distance":12.95,"elevation":3953.8},
      {"distance":13.05,"elevation":3959.6},
      {"distance":13.15,"elevation":3961.4},
      {"distance":13.27,"elevation":3955.4},
      {"distance":13.35,"elevation":3951.6},
      {"distance":13.45,"elevation":3936.2},
      {"distance":13.55,"elevation":3930.0},
      {"distance":13.65,"elevation":3927.8},
      {"distance":13.75,"elevation":3930.4},
      {"distance":13.85,"elevation":3939.8},
      {"distance":13.95,"elevation":3941.0},
      {"distance":14.05,"elevation":3927.2},
      {"distance":14.15,"elevation":3923.2},
      {"distance":14.25,"elevation":3921.6},
      {"distance":14.36,"elevation":3922.0},
      {"distance":14.45,"elevation":3930.0},
      {"distance":14.55,"elevation":3941.6},
      {"distance":14.65,"elevation":3932.0},
      {"distance":14.75,"elevation":3911.4},
      {"distance":14.85,"elevation":3892.0},
      {"distance":14.95,"elevation":3874.4},
      {"distance":15.05,"elevation":3851.2},
      {"distance":15.15,"elevation":3837.6},
      {"distance":15.26,"elevation":3818.2},
      {"distance":15.35,"elevation":3823.6},
      {"distance":15.45,"elevation":3836.2},
      {"distance":15.56,"elevation":3857.2},
      {"distance":15.65,"elevation":3878.6},
      {"distance":15.75,"elevation":3879.2},
      {"distance":15.86,"elevation":3871.6},
      {"distance":15.95,"elevation":3877.0},
      {"distance":16.05,"elevation":3877.0},
      {"distance":16.15,"elevation":3888.4},
      {"distance":16.25,"elevation":3900.2},
      {"distance":16.35,"elevation":3907.2},
      {"distance":16.45,"elevation":3926.6},
      {"distance":16.55,"elevation":3930.0},
      {"distance":16.65,"elevation":3941.4},
      {"distance":16.75,"elevation":3946.0},
      {"distance":16.85,"elevation":3946.6},
      {"distance":16.95,"elevation":3946.2},
      {"distance":17.06,"elevation":3944.6},
      {"distance":17.16,"elevation":3941.0},
      {"distance":17.25,"elevation":3930.2},
      {"distance":17.35,"elevation":3923.8},
      {"distance":17.45,"elevation":3910.6},
      {"distance":17.55,"elevation":3909.0},
      {"distance":17.65,"elevation":3889.4},
      {"distance":17.75,"elevation":3870.4},
      {"distance":17.85,"elevation":3848.2},
      {"distance":17.95,"elevation":3822.6},
      {"distance":18.05,"elevation":3808.0},
      {"distance":18.15,"elevation":3809.8},
      {"distance":18.25,"elevation":3806.4},
      {"distance":18.35,"elevation":3797.4},
      {"distance":18.45,"elevation":3783.4},
      {"distance":18.55,"elevation":3765.4},
      {"distance":18.65,"elevation":3730.8},
      {"distance":18.75,"elevation":3746.2},
      {"distance":18.85,"elevation":3751.4},
      {"distance":18.95,"elevation":3756.2},
      {"distance":19.05,"elevation":3771.6},
      {"distance":19.15,"elevation":3781.4},
      {"distance":19.25,"elevation":3786.0},
      {"distance":19.35,"elevation":3788.8},
      {"distance":19.45,"elevation":3787.0},
      {"distance":19.55,"elevation":3801.8},
      {"distance":19.65,"elevation":3811.4},
      {"distance":19.75,"elevation":3805.0},
      {"distance":19.85,"elevation":3796.6},
      {"distance":19.95,"elevation":3799.8},
      {"distance":20.05,"elevation":3796.6},
      {"distance":20.15,"elevation":3792.8},
      {"distance":20.25,"elevation":3787.6},
      {"distance":20.35,"elevation":3783.2},
      {"distance":20.46,"elevation":3776.4},
      {"distance":20.55,"elevation":3773.4},
      {"distance":20.65,"elevation":3772.4},
      {"distance":20.75,"elevation":3768.0},
      {"distance":20.85,"elevation":3760.4},
      {"distance":20.95,"elevation":3755.8},
      {"distance":21.05,"elevation":3746.0},
      {"distance":21.15,"elevation":3736.2},
      {"distance":21.25,"elevation":3726.4},
      {"distance":21.35,"elevation":3718.0},
      {"distance":21.46,"elevation":3710.2},
      {"distance":21.55,"elevation":3704.0},
      {"distance":21.65,"elevation":3694.8},
      {"distance":21.75,"elevation":3693.0},
      {"distance":21.85,"elevation":3685.2},
      {"distance":21.95,"elevation":3672.8},
      {"distance":22.05,"elevation":3659.2},
      {"distance":22.15,"elevation":3646.6},
      {"distance":22.25,"elevation":3633.0},
      {"distance":22.35,"elevation":3625.0},
      {"distance":22.46,"elevation":3611.4},
      {"distance":22.55,"elevation":3597.8},
      {"distance":22.65,"elevation":3580.6},
      {"distance":22.75,"elevation":3548.4},
      {"distance":22.85,"elevation":3523.8},
      {"distance":22.95,"elevation":3499.8},
      {"distance":23.05,"elevation":3482.2},
      {"distance":23.15,"elevation":3480.4},
      {"distance":23.26,"elevation":3480.0},
      {"distance":23.28,"elevation":3481.4}
    ],
    "stats": {
      "min": 3475,
      "max": 4076,
      "gain": 1609,
      "totalDistance": 23.3
    }
  }
];

        let elevationCharts = {};
        let currentGpxIndex = 0;

        function initElevationCharts() {
            const elevationSection = document.getElementById('elevationSection');
            const elevationContent = document.getElementById('elevationContent');
            const gpxTabs = document.getElementById('gpxTabs');
            const downloadBtn = document.getElementById('downloadElevationBtn');

            // Check if elevation data exists and is valid
            if (!elevationDataSets || elevationDataSets.length === 0 ||
                (typeof elevationDataSets === 'string' && elevationDataSets.includes('{{'))) {
                // No elevation data - show message
                elevationContent.innerHTML = `
                    <div class="no-elevation-data">
                        <p>No GPX data available</p>
                        <p style="font-size: 13px;">Upload GPX files to generate elevation profile</p>
                    </div>
                `;
                downloadBtn.style.display = 'none';
                return;
            }

            // Show tabs if multiple GPX files
            if (elevationDataSets.length > 1) {
                gpxTabs.style.display = 'flex';
                gpxTabs.innerHTML = elevationDataSets.map((dataset, index) => `
                    <button class="gpx-tab ${index === 0 ? 'active' : ''}"
                            onclick="switchGpxTab(${index})">
                        ${dataset.name || 'GPX ' + (index + 1)}
                    </button>
                `).join('');
            }

            // Create chart panels for each GPX file
            elevationContent.innerHTML = elevationDataSets.map((dataset, index) => `
                <div class="gpx-chart-panel ${index === 0 ? 'active' : ''}" id="gpxPanel${index}">
                    <div class="elevation-chart-container">
                        <div class="elevation-chart-wrapper">
                            <canvas id="elevationChart${index}"></canvas>
                        </div>
                    </div>
                    <div class="elevation-stats">
                        <div class="elevation-stat">
                            <div class="elevation-stat-value">${dataset.stats?.min || '--'}m</div>
                            <div class="elevation-stat-label">Min Elevation</div>
                        </div>
                        <div class="elevation-stat">
                            <div class="elevation-stat-value">${dataset.stats?.max || '--'}m</div>
                            <div class="elevation-stat-label">Max Elevation</div>
                        </div>
                        <div class="elevation-stat">
                            <div class="elevation-stat-value">${dataset.stats?.gain || '--'}m</div>
                            <div class="elevation-stat-label">Total Gain</div>
                        </div>
                        <div class="elevation-stat">
                            <div class="elevation-stat-value">${dataset.stats?.totalDistance?.toFixed(1) || '--'} km</div>
                            <div class="elevation-stat-label">Distance</div>
                        </div>
                    </div>
                </div>
            `).join('');

            // Initialize charts
            elevationDataSets.forEach((dataset, index) => {
                createElevationChart(index, dataset);
            });
        }

        function createElevationChart(index, dataset) {
            const ctx = document.getElementById(`elevationChart${index}`);
            if (!ctx || !dataset.data) return;

            const labels = dataset.data.map(p => p.distance.toFixed(2));
            const data = dataset.data.map(p => p.elevation);

            elevationCharts[index] = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Elevation (m)',
                        data: data,
                        fill: true,
                        backgroundColor: 'rgba(45, 90, 61, 0.3)',
                        borderColor: '#2D5A3D',
                        borderWidth: 2,
                        pointRadius: 0,
                        pointHoverRadius: 4,
                        pointHoverBackgroundColor: '#2D5A3D',
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: '#1A202C',
                            titleFont: { family: "'Source Sans 3', sans-serif" },
                            bodyFont: { family: "'Source Sans 3', sans-serif" },
                            callbacks: {
                                title: function(items) {
                                    return `Distance: ${items[0].label} km`;
                                },
                                label: function(context) {
                                    return `Elevation: ${context.raw.toFixed(0)}m`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: 'Distance (km)',
                                font: { family: "'Source Sans 3', sans-serif", size: 12 },
                                color: '#64748b'
                            },
                            ticks: {
                                font: { family: "'Source Sans 3', sans-serif", size: 11 },
                                color: '#64748b',
                                maxTicksLimit: 10,
                                callback: function(value, index) {
                                    const label = this.getLabelForValue(value);
                                    return parseFloat(label).toFixed(1);
                                }
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: true,
                                text: 'Elevation (m)',
                                font: { family: "'Source Sans 3', sans-serif", size: 12 },
                                color: '#64748b'
                            },
                            ticks: {
                                font: { family: "'Source Sans 3', sans-serif", size: 11 },
                                color: '#64748b'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                }
            });
        }

        function switchGpxTab(index) {
            // Update tabs
            document.querySelectorAll('.gpx-tab').forEach((tab, i) => {
                tab.classList.toggle('active', i === index);
            });

            // Update panels
            document.querySelectorAll('.gpx-chart-panel').forEach((panel, i) => {
                panel.classList.toggle('active', i === index);
            });

            currentGpxIndex = index;
        }

        function downloadElevationPNG() {
            const chart = elevationCharts[currentGpxIndex];
            if (!chart) {
                showToast('No chart to download');
                return;
            }

            const canvas = chart.canvas;

            // Create a new canvas with white background and padding
            const exportCanvas = document.createElement('canvas');
            const padding = 40;
            exportCanvas.width = canvas.width + (padding * 2);
            exportCanvas.height = canvas.height + (padding * 2) + 60;

            const exportCtx = exportCanvas.getContext('2d');

            // White background
            exportCtx.fillStyle = '#FFFFFF';
            exportCtx.fillRect(0, 0, exportCanvas.width, exportCanvas.height);

            // Add title
            exportCtx.fillStyle = '#1A202C';
            exportCtx.font = "600 18px 'Source Sans 3', sans-serif";
            exportCtx.textAlign = 'center';
            const title = elevationDataSets[currentGpxIndex]?.name || 'Elevation Profile';
            exportCtx.fillText(title, exportCanvas.width / 2, 35);

            // Add branding
            exportCtx.fillStyle = '#64748b';
            exportCtx.font = "400 12px 'Source Sans 3', sans-serif";
            exportCtx.fillText('Adventure Athlete India', exportCanvas.width / 2, 55);

            // Draw the chart
            exportCtx.drawImage(canvas, padding, 70);

            // Download
            const link = document.createElement('a');
            const gpxName = elevationDataSets[currentGpxIndex]?.name?.replace(/[^a-z0-9]/gi, '-').toLowerCase() || 'elevation-profile';
            link.download = `${gpxName}-elevation.png`;
            link.href = exportCanvas.toDataURL('image/png');
            link.click();

            showToast('Elevation graph downloaded!');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            syncContent('website');
            syncContent('instagram');
            syncContent('youtube');
            syncContent('summary');
            updateCharCount('instagram');

            // Hide YouTube section if no content
            const ytContent = document.getElementById('youtubeDisplay').textContent;
            if (!ytContent || ytContent.includes('{{')) {
                document.getElementById('youtubeSection').style.display = 'none';
            }

            // Initialize elevation charts
            initElevationCharts();
        });
    </script>
</body>
</html>
